
export class Relic {
  static new(options: {
    id: string
    color: Exclude<RelicColor, RelicColor.Free>
    effects: number[]
    itemId: number
  }): Relic {
    return new Relic(options.id, options.color, options.effects, options.itemId)
  }

  get size(): 'small' | 'medium' | 'large' {
    switch (this.effects.length) {
      case 1:
        return 'small'
      case 2:
        return 'medium'
      case 3:
        return 'large'
      default:
        throw new Error(`Unexpected effects length: ${this.effects.length}`)
    }
  }

  get name(): string {
    const itemName = uniqItemNameMap[this.itemId]

    if (itemName) return itemName

    const sizeMap = {
      small: '繊細な',
      medium: '端正な',
      large: '壮大な',
    }
    const colorMap = {
      [RelicColor.Red]: '燃える',
      [RelicColor.Blue]: '滴る',
      [RelicColor.Yellow]: '輝く',
      [RelicColor.Green]: '静まる',
    }

    const prefix = sizeMap[this.size]
    const color = colorMap[this.color]

    return `${prefix}${color}景色`
  }

  get normalizedEffectIds() {
    return this.effects.map(normalizeEffectId)
  }

  private constructor(
    /** 遺物のID */
    public id: string,

    /** 遺物の色 */
    public color: Exclude<RelicColor, RelicColor.Free>,

    /** 遺物の効果 */
    public effects: number[],

    /** 遺物のアイテムID */
    public itemId: number,
  ) { }
}

export const enum RelicColor {
  Red = 'Red',
  Blue = 'Blue',
  Green = 'Green',
  Yellow = 'Yellow',
  Free = 'Free',
}

/**
 * @see https://docs.google.com/spreadsheets/d/1Gz6fqIBNr2BXr45te9ewTolHJr4zZ_Apbqa09gL3VbI/
 */
export const relicEffectMap: Record<number, string> = {
  10000: '攻撃連続時、FP回復',
  10001: '攻撃を受けると攻撃力上昇',
  7000000: '生命力+1',
  7000001: '生命力+2',
  7000002: '生命力+3',
  7000090: '最大HP上昇',
  7000100: '精神力+1',
  7000101: '精神力+2',
  7000102: '精神力+3',
  7000190: '最大FP上昇',
  7000200: '持久力+1',
  7000201: '持久力+2',
  7000202: '持久力+3',
  7000290: '最大スタミナ上昇',
  7000300: '筋力+1',
  7000301: '筋力+2',
  7000302: '筋力+3',
  7000400: '技量+1',
  7000401: '技量+2',
  7000402: '技量+3',
  7000500: '知力+1',
  7000501: '知力+2',
  7000502: '知力+3',
  7000600: '信仰+1',
  7000601: '信仰+2',
  7000602: '信仰+3',
  7000700: '神秘+1',
  7000701: '神秘+2',
  7000702: '神秘+3',
  7000800: 'スキルクールタイム軽減+1',
  7000801: 'スキルクールタイム軽減+2',
  7000802: 'スキルクールタイム軽減+3',
  7000900: 'アーツゲージ蓄積増加+1',
  7000901: 'アーツゲージ蓄積増加+2',
  7000902: 'アーツゲージ蓄積増加+3',
  7001000: '強靭度+1',
  7001001: '強靭度+2',
  7001002: '強靭度+3',
  7001100: 'HP持続回復',
  7001400: '物理攻撃力上昇',
  7001401: '物理攻撃力上昇+1',
  7001402: '物理攻撃力上昇+2',
  7001403: '物理攻撃力上昇+3',
  7001500: '魔力攻撃力上昇',
  7001501: '魔力攻撃力上昇+1',
  7001502: '魔力攻撃力上昇+2',
  7001600: '炎攻撃力上昇',
  7001601: '炎攻撃力上昇+1',
  7001602: '炎攻撃力上昇+2',
  7001700: '雷攻撃力上昇',
  7001701: '雷攻撃力上昇+1',
  7001702: '雷攻撃力上昇+2',
  7001800: '聖攻撃力上昇',
  7001801: '聖攻撃力上昇+1',
  7001802: '聖攻撃力上昇+2',
  7002600: '魔力カット率上昇',
  7002700: '炎カット率上昇',
  7002800: '雷カット率上昇',
  7002900: '聖カット率上昇',
  7003000: '毒耐性上昇',
  7003100: '出血耐性上昇',
  7003200: '睡眠耐性上昇',
  7003300: '死耐性上昇',
  7003400: '腐敗耐性上昇',
  7003500: '冷気耐性上昇',
  7003600: '発狂耐性上昇',
  7005600: 'ダメージを受けた直後、攻撃によりHPの一部を回復',
  7006000: '両手持ちの、体勢を崩す力上昇',
  // 7006001: '両手持ちの、体勢を崩す力上昇',
  7006100: '二刀持ちの、体勢を崩す力上昇',
  7006101: '二刀持ちの、体勢を崩す力上昇+1',
  7010200: '聖杯瓶の回復を、周囲の味方に分配',
  7010500: '[追跡者] アーツ発動時、周囲を延焼',
  7010700: '[レディ] 短剣による連続攻撃時、周囲の敵に直近の出来事を再演',
  7010900: '[復讐者] アーツ発動時、自身のHPと引き換えに周囲の味方のHPを全回復',
  7011000: '[守護者] スキルの持続時間延長',
  7011200: '[復讐者] アーツ発動時、霊炎の爆発を発生',
  7011600: '[守護者] 斧槍タメ攻撃時、つむじ風が発生',
  7011700: '[執行者] アーツ発動中、咆哮でHP回復',
  7012000: '[守護者] アーツ発動時、周囲の味方HPを徐々に回復',
  7012200: 'HP低下時、周囲の味方を含めHPをゆっくりと回復',
  7020000: '[追跡者] スキル使用時、追加攻撃できる(大剣のみ)',
  7030000: 'トーテム・ステラの周囲で、強靭度上昇',
  7030200: '苔薬、干し肉などのアイテム使用でHP回復',
  7030600: 'ガード成功時、アーツゲージを蓄積',
  7030700: 'ガード中、敵に狙われやすくなる',
  7030800: '致命の一撃で、アーツゲージ蓄積増加',
  7030900: '脂アイテム使用時、追加で攻撃力上昇',
  7031200: '[復讐者] アーツ発動時、ファミリーと味方を強化',
  7031300: '[無頼漢] スキル中に攻撃を受けると攻撃力と最大スタミナ上昇',
  7031800: '[レディ] 背後からの致命の一撃後、自身の姿を見え難くし、足音を消す',
  7031900: '致命の一撃で、ルーンを獲得',
  7032400: '[追跡者] アビリティ発動時、アーツゲージ増加',
  7032700: '[レディ] アーツ発動中、敵撃破で攻撃力上昇',
  7032800: '[隠者] 属性痕を集めた時、「魔術の地」が発動',
  7032900: '[隠者] アーツ発動時、自身が出血状態になり、攻撃力上昇',
  7033200: '[追跡者] スキルの使用回数+1',
  7033400: '[守護者] アビリティ発動時、被ダメージを一部返す',
  7034100: '[隠者] アーツ発動時、最大HP上昇',
  7034400: '[執行者] スキル中の攻撃力上昇、攻撃時にHP減少',
  7034500: '[執行者] スキル中、妖刀が解放状態になるとHP回復',
  7034600: '[鉄の目] アーツのタメ発動時、毒の状態異常を付加',
  7034700: '[鉄の目] アーツ発動後、刺突カウンター強化',
  7035100: '致命の一撃で、スタミナ回復速度上昇',
  7035400: 'ジェスチャー「あぐら」により、発狂が蓄積',
  7035500: '発狂状態になると、FP持続回復',
  7035700: '武器の持ち替え時、いずれかの属性攻撃力を付加',
  7035800: '属性攻撃力が付加された時、属性攻撃力上昇',
  7035900: '武器の持ち替え時、物理攻撃力上昇',
  7036100: 'ガード成功時、HPを回復',
  7040000: '通常攻撃の1段階目強化',
  7040100: 'ガードカウンター強化',
  7040200: '致命の一撃強化',
  7040201: '致命の一撃強化+1',
  7040300: '投擲壺の攻撃力上昇',
  7040400: '投擲ナイフの攻撃力上昇',
  7040500: '投擲石の攻撃力上昇',
  7043000: '咆哮とブレス強化',
  7043100: '調香術強化',
  7043200: '石堀りの魔術を強化',
  7043300: 'カーリアの剣の魔術を強化',
  7043400: '輝剣の魔術を強化',
  7043500: '不可視の魔術を強化',
  7043600: '結晶人の魔術を強化',
  7043700: '重力の魔術を強化',
  7043800: '茨の魔術を強化',
  7043900: '夜の魔術を強化',
  7044000: '黄金律原理主義の祈祷を強化',
  7044100: '王都古竜信仰の祈祷を強化',
  7044200: '巨人の火の祈祷を強化',
  7044300: '神狩りの祈祷を強化',
  7044400: '獣の祈祷を強化',
  7044500: '狂い火の祈祷を強化',
  7044600: '竜餐の祈祷を強化',
  7050000: '自身を除く、周囲の味方のスタミナ回復速度上昇',
  7050100: 'アイテムの効果が周囲の味方にも発動',
  7060000: '封牢の囚を倒す度、永続で攻撃力上昇',
  7060100: '魔術師塔の仕掛けが解除される度、永続で最大FP上昇',
  7060200: '夜の侵入者を倒す度に、攻撃力上昇',
  7070000: '埋もれ宝の位置を地図に表示',
  7080000: '短剣の武器種を3つ以上装備していると攻撃力上昇',
  7080100: '直剣の武器種を3つ以上装備していると攻撃力上昇',
  7080200: '大剣の武器種を3つ以上装備していると攻撃力上昇',
  7080300: '特大剣の武器種を3つ以上装備していると攻撃力上昇',
  7080400: '曲剣の武器種を3つ以上装備していると攻撃力上昇',
  7080500: '大曲剣の武器種を3つ以上装備していると攻撃力上昇',
  7080600: '刀の武器種を3つ以上装備していると攻撃力上昇',
  7080700: '両刃剣の武器種を3つ以上装備していると攻撃力上昇',
  7080800: '刺剣の武器種を3つ以上装備していると攻撃力上昇',
  7080900: '重刺剣の武器種を3つ以上装備していると攻撃力上昇',
  7081000: '斧の武器種を3つ以上装備していると攻撃力上昇',
  7081100: '大斧の武器種を3つ以上装備していると攻撃力上昇',
  7081200: '槌の武器種を3つ以上装備していると攻撃力上昇',
  7081300: '大槌の武器種を3つ以上装備していると攻撃力上昇',
  7081400: 'フレイルの武器種を3つ以上装備していると攻撃力上昇',
  7081500: '槍の武器種を3つ以上装備していると攻撃力上昇',
  7081700: '大槍の武器種を3つ以上装備していると攻撃力上昇',
  7081800: '斧槍の武器種を3つ以上装備していると攻撃力上昇',
  7081900: '鎌の武器種を3つ以上装備していると攻撃力上昇',
  7082000: '拳の武器種を3つ以上装備していると攻撃力上昇',
  7082100: '爪の武器種を3つ以上装備していると攻撃力上昇',
  7082200: '鞭の武器種を3つ以上装備していると攻撃力上昇',
  7082300: '特大武器の武器種を3つ以上装備していると攻撃力上昇',
  7082400: '弓の武器種を3つ以上装備していると攻撃力上昇',
  7082500: '杖の武器種を3つ以上装備していると最大FP上昇',
  7082600: '聖印の武器種を3つ以上装備していると最大FP上昇',
  7082700: '小盾の武器種を3つ以上装備していると最大HP上昇',
  7082800: '中盾の武器種を3つ以上装備していると最大HP上昇',
  7082900: '大盾の武器種を3つ以上装備していると最大HP上昇',
  7090000: '敵を倒した時のアーツゲージ蓄積量が上昇',
  7090100: '敵を倒した時、自身を除く周囲の味方のHPを回復',
  7090300: 'トーテム・ステラの周囲で敵を倒した時、HP回復',
  7100100: '攻撃成功時、スタミナ回復',
  7100110: '攻撃成功時、スタミナ回復+1',
  // 7100190: '攻撃成功時、スタミナ回復+1',
  7110000: '自身と味方の取得ルーン増加',
  7120000: '出撃時の武器に魔力攻撃力を付加',
  7120100: '出撃時の武器に炎攻撃力を付加',
  7120200: '出撃時の武器に雷攻撃力を付加',
  7120300: '出撃時の武器に聖攻撃力を付加',
  7120400: '出撃時の武器に冷気の状態異常を付加',
  7120500: '出撃時の武器に毒の状態異常を付加',
  7120600: '出撃時の武器に出血の状態異常を付加',
  7120900: '出撃時に「石剣の鍵」を持つ',
  7121000: '出撃時に「小さなポーチ」を持つ',
  7121100: '出撃時に「火炎壺」を持つ',
  7121200: '出撃時に「魔力壺」を持つ',
  7121300: '出撃時に「雷壺」を持つ',
  7121400: '出撃時に「聖水壺」を持つ',
  7121500: '出撃時に「骨の毒投げ矢」を持つ',
  7121600: '出撃時に「結晶投げ矢」を持つ',
  7121700: '出撃時に「スローイングダガー」を持つ',
  7121800: '出撃時に「屑輝石」を持つ',
  7121900: '出撃時に「塊の重力石」を持つ',
  7122000: '出撃時に「誘惑の枝」を持つ',
  7122100: '出撃時に「呪霊喚びの鈴」を持つ',
  7122200: '出撃時に「火脂」を持つ',
  7122300: '出撃時に「魔力脂」を持つ',
  7122400: '出撃時に「雷脂」を持つ',
  7122500: '出撃時に「聖脂」を持つ',
  7122600: '出撃時に「盾脂」を持つ',
  7122700: '出撃時の武器の戦技を「輝剣の円陣」にする',
  7122800: '出撃時の武器の戦技を「グラビタス」にする',
  7122900: '出撃時の武器の戦技を「炎撃」にする',
  7123000: '出撃時の武器の戦技を「溶岩噴火」にする',
  7123100: '出撃時の武器の戦技を「落雷」にする',
  7123200: '出撃時の武器の戦技を「雷撃斬」にする',
  7123300: '出撃時の武器の戦技を「聖なる刃」にする',
  7123400: '出撃時の武器の戦技を「祈りの一撃」にする',
  7123500: '出撃時の武器の戦技を「毒の霧」にする',
  7123600: '出撃時の武器の戦技を「毒蛾は二度舞う」にする',
  7123700: '出撃時の武器の戦技を「血の刃」にする',
  7123800: '出撃時の武器の戦技を「切腹」にする',
  7123900: '出撃時の武器の戦技を「冷気の霧」にする',
  7124000: '出撃時の武器の戦技を「霜踏み」にする',
  7124100: '出撃時の武器の戦技を「白い影の誘い」にする',
  7124300: '出撃時の武器の戦技を「我慢」にする',
  7124400: '出撃時の武器の戦技を「クイックステップ」にする',
  7124500: '出撃時の武器の戦技を「嵐撃」にする',
  7124600: '出撃時の武器の戦技を「デタミネーション」にする',
  7124700: '出撃時の武器の戦技を「アローレイン」にする',
  7126000: '出撃時に「星光の欠片」を持つ',
  // 7126001: '出撃時に「星光の欠片」を持つ',
  // 7126002: '出撃時に「星光の欠片」を持つ',
  7150000: 'ガードカウンターに、自身の現在HPの一部を加える',
  7160000: '刺突カウンター発生時、HP回復',
  7220000: '[復讐者] ファミリーと共闘中の間、自身を強化する',
  7230000: '出撃中、ショップでの購入に必要なルーンが割引',
  7230001: '出撃中、ショップでの購入に必要なルーンが大割引',
  7240000: 'ダメージで吹き飛ばされた時、強靭度とカット率上昇',
  7260000: '毒状態の敵に対する攻撃を強化',
  7260300: '腐敗状態の敵に対する攻撃を強化',
  7260400: '凍傷状態の敵に対する攻撃を強化',
  7260700: '周囲で凍傷状態の発生時、自身の姿を隠す',
  7260710: '周囲で毒／腐敗状態発生時、攻撃力上昇',
  // 7260800: '周囲で毒／腐敗状態発生時、攻撃力上昇',
  7270100: '[鉄の目] スキルの使用回数+1',
  7280000: '[鉄の目] 弱点の持続時間を延長させる',
  7290000: '[レディ] スキルのダメージ上昇',
  7310000: '[無頼漢] アーツの効果時間延長',
  7330000: '短剣の攻撃力上昇',
  7330100: '直剣の攻撃力上昇',
  7330200: '大剣の攻撃力上昇',
  7330300: '特大剣の攻撃力上昇',
  7330400: '曲剣の攻撃力上昇',
  7330500: '大曲剣の攻撃力上昇',
  7330600: '刀の攻撃力上昇',
  7330700: '両刃剣の攻撃力上昇',
  7330800: '刺剣の攻撃力上昇',
  7330900: '重刺剣の攻撃力上昇',
  7331000: '斧の攻撃力上昇',
  7331100: '大斧の攻撃力上昇',
  7331200: '槌の攻撃力上昇',
  7331300: '大槌の攻撃力上昇',
  7331400: 'フレイルの攻撃力上昇',
  7331500: '槍の攻撃力上昇',
  7331700: '大槍の攻撃力上昇',
  7331800: '斧槍の攻撃力上昇',
  7331900: '鎌の攻撃力上昇',
  7332000: '拳の攻撃力上昇',
  7332100: '爪の攻撃力上昇',
  7332200: '鞭の攻撃力上昇',
  7332300: '特大武器の攻撃力上昇',
  7332400: '弓の攻撃力上昇',
  7340000: '短剣の攻撃でHP回復',
  7340100: '直剣の攻撃でHP回復',
  7340200: '大剣の攻撃でHP回復',
  7340300: '特大剣の攻撃でHP回復',
  7340400: '曲剣の攻撃でHP回復',
  7340500: '大曲剣の攻撃でHP回復',
  7340600: '刀の攻撃でHP回復',
  7340700: '両刃剣の攻撃でHP回復',
  7340800: '刺剣の攻撃でHP回復',
  7340900: '重刺剣の攻撃でHP回復',
  7341000: '斧の攻撃でHP回復',
  7341100: '大斧の攻撃でHP回復',
  7341200: '槌の攻撃でHP回復',
  7341300: '大槌の攻撃でHP回復',
  7341400: 'フレイルの攻撃でHP回復',
  7341500: '槍の攻撃でHP回復',
  7341700: '大槍の攻撃でHP回復',
  7341800: '斧槍の攻撃でHP回復',
  7341900: '鎌の攻撃でHP回復',
  7342000: '拳の攻撃でHP回復',
  7342100: '爪の攻撃でHP回復',
  7342200: '鞭の攻撃でHP回復',
  7342300: '特大武器の攻撃でHP回復',
  7342400: '弓の攻撃でHP回復',
  7350000: '短剣の攻撃でFP回復',
  7350100: '直剣の攻撃でFP回復',
  7350200: '大剣の攻撃でFP回復',
  7350300: '特大剣の攻撃でFP回復',
  7350400: '曲剣の攻撃でFP回復',
  7350500: '大曲剣の攻撃でFP回復',
  7350600: '刀の攻撃でFP回復',
  7350700: '両刃剣の攻撃でFP回復',
  7350800: '刺剣の攻撃でFP回復',
  7350900: '重刺剣の攻撃でFP回復',
  7351000: '斧の攻撃でFP回復',
  7351100: '大斧の攻撃でFP回復',
  7351200: '槌の攻撃でFP回復',
  7351300: '大槌の攻撃でFP回復',
  7351400: 'フレイルの攻撃でFP回復',
  7351500: '槍の攻撃でFP回復',
  7351700: '大槍の攻撃でFP回復',
  7351800: '斧槍の攻撃でFP回復',
  7351900: '鎌の攻撃でFP回復',
  7352000: '拳の攻撃でFP回復',
  7352100: '爪の攻撃でFP回復',
  7352200: '鞭の攻撃でFP回復',
  7352300: '特大武器の攻撃でFP回復',
  7352400: '弓の攻撃でFP回復',
  8660101: 'HP低下時、カット率上昇',
}

/**
 * 重複とみなされる遺物効果のIDを正規化する
 *
 * @param id - 遺物効果のID
 */
export function normalizeEffectId(id: number): number {
  return (
    {
      7100190: 7100110,
      7126001: 7126000,
      7126002: 7126000,
      7260800: 7260710,
      7006001: 7006000,
      7036000: 10000,
      7032200: 10001,
    }[id] || id
  )
}

const uniqItemNameMap: Record<number, string> = {
  10001: '薄汚れたフレーム',
  15002: '黒爪の首飾り',
  18000: '祝福された花',
  14002: '祝福された鉄貨',
  17002: '骨のような石',
  13001: '割れた封蝋',
  12003: '砕けた魔女のブローチ',
  14001: '頭冠のメダル',
  13002: '聖律の刃',
  10002: '忌み鬼の呪物',
  14000: '金色の露',
  18002: '黄金の萌芽',
  10000: '古びた懐中時計',
  16002: '古びたミニアチュール',
  11002: '銀の雫',
  11000: 'にび色の砥石',
  16001: '小さな化粧道具',
  12001: '石の杭',
  11001: '追跡者の耳飾り',
  12000: '三冊目の本',
  15000: 'ちぎれた組み紐',
  17001: '夜の痕跡',
  12002: '魔女のブローチ',
  2000: '獣の夜',
  2010: '爵の夜',
  2011: '爵の暗き夜',
  2020: '識の夜',
  2021: '識の暗き夜',
  2030: '深海の夜',
  2040: '魔の夜',
  2050: '狩人の夜',
  2051: '狩人の暗き夜',
  2060: '霞の夜',
  2100: '王の夜',
}
